<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Documentation &mdash; protein_inference 0.1.2 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="To Do List" href="to_do_list.html" />
    <link rel="prev" title="License" href="license.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html"><img src="_static/protein_inference_logo_v2.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparing_input_data.html">Preparing Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="protein_inference_in_python.html">Protein Inference in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-protein_inference.problem_network">Core Functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-protein_inference.processing.processed_psms">Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-protein_inference.inference.false_discovery_rate_calculator">Inference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="to_do_list.html">To Do List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">protein_inference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/documentation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline"></a></h1>
<div class="section" id="module-protein_inference.problem_network">
<span id="core-functionality"></span><h2>Core Functionality<a class="headerlink" href="#module-protein_inference.problem_network" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt id="protein_inference.problem_network.ProblemNetwork">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.problem_network.</code><code class="sig-name descname">ProblemNetwork</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork" title="Permalink to this definition"></a></dt>
<dd><p>Stores a networkx object with nodes for proteins and
peptides and edges for PSMs (protein-spectral-matches).</p>
<p>This object stores the protein-peptide PSM network along
with several handy methods that support tagging, scoring
and plotting functionalities.</p>
<dl class="py attribute">
<dt id="protein_inference.problem_network.ProblemNetwork.network">
<code class="sig-name descname">network</code><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.network" title="Permalink to this definition"></a></dt>
<dd><p>A networkx graph storing the ProblemNetwork</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>nx.Graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.get_edge_attribute_dict">
<code class="sig-name descname">get_edge_attribute_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attribute</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.get_edge_attribute_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of all edge:value
pairings for a particular value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attribute</strong> (<em>string</em>) – The name of the attribute for which to retrieve the
edge:value pairings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.get_node_attribute_dict">
<code class="sig-name descname">get_node_attribute_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attribute</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.get_node_attribute_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of all node:value
pairings for a particular value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attribute</strong> (<em>string</em>) – The name of the attribute for which to retrieve the
node:value pairings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.get_peptides">
<code class="sig-name descname">get_peptides</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.get_peptides" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of peptides contained in the network.</p>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.get_proteins">
<code class="sig-name descname">get_proteins</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.get_proteins" title="Permalink to this definition"></a></dt>
<dd><p>Return a list of the proteins contained in the network.</p>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.pick_nodes">
<code class="sig-name descname">pick_nodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attribute</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.pick_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of all nodes with a particular
attribute - value pairing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute</strong> (<em>string</em>) – The node attribute.</p></li>
<li><p><strong>value</strong> (<em>NA</em>) – The value the attribute must be set to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.print_edges">
<code class="sig-name descname">print_edges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.print_edges" title="Permalink to this definition"></a></dt>
<dd><p>Uses pretty print to show all edges and their
attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.print_nodes">
<code class="sig-name descname">print_nodes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.print_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Uses pretty print to show all nodes and their
attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.problem_network.ProblemNetwork.update_nodes">
<code class="sig-name descname">update_nodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">attribute</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.problem_network.ProblemNetwork.update_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Takes a list of nodes in the networks and gives them
a node <em>attribute</em> with a particular <em>value</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>list</em>) – A list of nodes ids (strings) to update.</p></li>
<li><p><strong>attribute</strong> (<em>string</em>) – The name of the attribute to update</p></li>
<li><p><strong>value</strong> (<em>NA</em>) – The value to set the attribute to. Can be string or float.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-protein_inference.network_grapher"></span><dl class="py class">
<dt id="protein_inference.network_grapher.NetworkGrapher">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.network_grapher.</code><code class="sig-name descname">NetworkGrapher</code><a class="headerlink" href="#protein_inference.network_grapher.NetworkGrapher" title="Permalink to this definition"></a></dt>
<dd><p>This class generates a pyvis graph representing a PSM network.</p>
<p>This class uses information encoded in the network component of the
ProblemNetwork class. It creates an interactive network representation
using the pyvis package. Several colouring options are available such
as by status, groups or score.</p>
<dl class="py method">
<dt id="protein_inference.network_grapher.NetworkGrapher.colour_by_group">
<code class="sig-name descname">colour_by_group</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.network_grapher.NetworkGrapher.colour_by_group" title="Permalink to this definition"></a></dt>
<dd><p>Updates the node colour attributes in a ProblemNetworks network attribute
according to the “allocated” and “major” attributes of those nodes”</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>pn: the ProblemNetwork to update.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.network_grapher.NetworkGrapher.colour_by_score">
<code class="sig-name descname">colour_by_score</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.network_grapher.NetworkGrapher.colour_by_score" title="Permalink to this definition"></a></dt>
<dd><p>Updates the node colour attributes in a ProblemNetworks network attribute
according to the score attributes of those nodes”</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>pn: the ProblemNetwork to update.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.network_grapher.NetworkGrapher.colour_by_status">
<code class="sig-name descname">colour_by_status</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.network_grapher.NetworkGrapher.colour_by_status" title="Permalink to this definition"></a></dt>
<dd><p>”
Updates the node colour attributes in a ProblemNetworks network attribute
according to the status attributes of those nodes”</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>pn: the ProblemNetwork to update.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.network_grapher.NetworkGrapher.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">problem_network</span></em>, <em class="sig-param"><span class="n">by</span><span class="o">=</span><span class="default_value">'status'</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'nx'</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">[800, 800]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.network_grapher.NetworkGrapher.draw" title="Permalink to this definition"></a></dt>
<dd><p>Draw creates the interactive network visualization from the
ProblemNetwork object using pyvis and the colouring methods in
this classs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>problem_network</strong> (<a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork"><em>ProblemNetwork</em></a>) – An instance of the problem network object</p></li>
<li><p><strong>by</strong> (<em>string</em>) – A string indicating the colouring method (“status”, “colour” or
“group”)</p></li>
<li><p><strong>name</strong> (<em>string</em>) – A string that will be used to generate the file name when the
visualization is saved as an HTML file.</p></li>
<li><p><strong>size</strong> (<em>list</em>) – A list of length two indicating the size in pixels of the
resulting visualization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A static HTML object that is also written to the current working directory.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-protein_inference.protein_inference_runner"></span><dl class="py class">
<dt id="protein_inference.protein_inference_runner.ProteinInferenceRunner">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.protein_inference_runner.</code><code class="sig-name descname">ProteinInferenceRunner</code><a class="headerlink" href="#protein_inference.protein_inference_runner.ProteinInferenceRunner" title="Permalink to this definition"></a></dt>
<dd><p>The main class that drives the protein inference workflow.</p>
<p>This class groups the main coordinating functions that organise
a protein inference workflow including PSM processing, graph
generation, splitting, tagging, scoring, fdr calculations
and output file writing.</p>
<p>To instantiate:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span> <span class="o">=</span> <span class="n">ProteinInferenceRunner</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="protein_inference.protein_inference_runner.ProteinInferenceRunner.get_output">
<code class="sig-name descname">get_output</code><span class="sig-paren">(</span><em class="sig-param">psms</em>, <em class="sig-param">decoy=0</em>, <em class="sig-param">scoring_method=&lt;class 'protein_inference.reprisal.greedy_algorithm.GreedyAlgorithm'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.protein_inference_runner.ProteinInferenceRunner.get_output" title="Permalink to this definition"></a></dt>
<dd><p>Processes either target or decoy data.</p>
<p>Preprocesses data,generates, splits and tags networks.
Scores proteins, merges proteins with identical neighbors
and retrieves protein and peptide tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psms</strong> (<em>pandas.DataFrame</em>) – A pandas dataframe contain a psms table.</p></li>
<li><p><strong>decoy</strong> (<em>bool</em>) – A boolean indicating whether decoys should be removed
from the input table.</p></li>
<li><p><strong>scoring_method</strong> (<em>scoring method object</em>) – A valid scoring method such as those in inference.scorers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>protein_table</strong> (<em>pandas.DataFrame</em>) – A pandas dataframe containing proteins and inference metrics.</p></li>
<li><p><strong>peptide_table</strong> (<em>pandas.DataFrame</em>) – A pandas dataframe containing peptides and assignments.</p></li>
<li><p><strong>solved_networks</strong> (<em>a list of problem networks with scores and node</em>) – labels.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.protein_inference_runner.ProteinInferenceRunner.parallel_apply">
<code class="sig-name descname">parallel_apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pns</span></em>, <em class="sig-param"><span class="n">func</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.protein_inference_runner.ProteinInferenceRunner.parallel_apply" title="Permalink to this definition"></a></dt>
<dd><p>Uses multiprocessing module in mython to apply a function
to every problem network in a list of networks</p>
<dl class="simple">
<dt>pns<span class="classifier">list</span></dt><dd><p>A list of ProblemNetworks.</p>
</dd>
<dt>func: function or method</dt><dd><p>A function or method that acts on a ProblemNetwork.</p>
</dd>
</dl>
<dl class="simple">
<dt>pns<span class="classifier">list</span></dt><dd><p>A list of processed ProblemNetworks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.protein_inference_runner.ProteinInferenceRunner.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">target_path</em>, <em class="sig-param">decoy_path</em>, <em class="sig-param">output_directory</em>, <em class="sig-param">scoring_method=&lt;class 'protein_inference.reprisal.greedy_algorithm.GreedyAlgorithm'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.protein_inference_runner.ProteinInferenceRunner.run" title="Permalink to this definition"></a></dt>
<dd><p>This method calls the protein inference workflow.</p>
<p>This method locates two psm tables, corresponding to target and decoy matches,
and uses them to generate output peptide and protein tables with scores and
false discovery rates indicating which proteins are inferred and which
peptides have been assigned to each protein (as evidence).</p>
<dl class="simple">
<dt>target_path<span class="classifier">string</span></dt><dd><p>A path to a valid psm table with target matches</p>
</dd>
<dt>decoy_path<span class="classifier">string</span></dt><dd><p>A path to a valid psm table with decoy matches</p>
</dd>
<dt>output_directory<span class="classifier">string</span></dt><dd><p>A path to the output directory</p>
</dd>
<dt>scoring_method<span class="classifier">scoring method object</span></dt><dd><p>A valid scoring method such as those in inference.scorers</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>reprisal.target.proteins.csv</strong> (<em>csv</em>) – A file in the output directory. Describes the inferences made.</p></li>
<li><p><strong>reprisal.target.peptides.csv</strong> (<em>csv</em>) – A file in the output directory. Describes the inferences made.</p></li>
<li><p><strong>target_networks.p</strong> (<em>pickle file</em>) – A file that can be loaded using pickle to retrieve the target networks
for visualization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.protein_inference_runner.ProteinInferenceRunner.write_tables">
<code class="sig-name descname">write_tables</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target_protein_table</span></em>, <em class="sig-param"><span class="n">target_peptide_table</span></em>, <em class="sig-param"><span class="n">decoy_protein_table</span></em>, <em class="sig-param"><span class="n">decoy_peptide_table</span></em>, <em class="sig-param"><span class="n">output_directory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.protein_inference_runner.ProteinInferenceRunner.write_tables" title="Permalink to this definition"></a></dt>
<dd><p>Writes tables to csvs.</p>
<dl class="simple">
<dt>target_protein_table<span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas dataframe containing proteins and inference metrics.</p>
</dd>
<dt>target_peptide_table<span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas dataframe containing peptides and assignments.</p>
</dd>
<dt>decoy_protein_table<span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas dataframe containing proteins and inference metrics.</p>
</dd>
<dt>decoy_peptide_table<span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas dataframe containing peptides and assignments.</p>
</dd>
<dt>output_directory<span class="classifier">string</span></dt><dd><p>A path to the output directory</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>reprisal.target.proteins.csv</strong> (<em>csv</em>) – A file in the output directory. Describes the inferences made.</p></li>
<li><p><strong>reprisal.target.peptides.csv</strong> (<em>csv</em>) – A file in the output directory. Describes the inferences made.</p></li>
<li><p><strong>reprisal.decoy.proteins.csv</strong> (<em>csv</em>) – A file in the output directory. Describes the inferences made.</p></li>
<li><p><strong>reprisal.decoy.peptides.csv</strong> (<em>csv</em>) – A file in the output directory. Describes the inferences made.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-protein_inference.table_maker"></span><dl class="py class">
<dt id="protein_inference.table_maker.TableMaker">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.table_maker.</code><code class="sig-name descname">TableMaker</code><a class="headerlink" href="#protein_inference.table_maker.TableMaker" title="Permalink to this definition"></a></dt>
<dd><p>A class that groups functions required to generate output tables.</p>
<dl class="simple">
<dt>get_protein_table(pn)</dt><dd><p>Processes a ProblemNetwork to retrieve the corresponding protein
table</p>
</dd>
<dt>get_protein_tables(pns)</dt><dd><p>Processes a list of ProblemNetworks to retrieve the corresponding protein
tables in a list.</p>
</dd>
<dt>get_system_protein_table(pns):</dt><dd><p>Processes a list of ProblemNetworks to retrieve the corresponding protein
table.</p>
</dd>
<dt>get_peptide_table(pn)</dt><dd><p>Processes a ProblemNetwork to retrieve the corresponding peptide
table</p>
</dd>
<dt>get_peptide_tables(pns)</dt><dd><p>Processes a list of ProblemNetwork to retrieve the corresponding peptide
tables in a list.</p>
</dd>
<dt>get_system_peptide_table(pns):</dt><dd><p>Processes a list of ProblemNetworks to retrieve the corresponding peptide
table.</p>
</dd>
<dt>_get_edge_list(pn):</dt><dd><p>Retrieves a pandas dataframe encoding the edges from peptide to protein
for each edge in a ProblemNetwork.</p>
</dd>
<dt>find_molecule(pns, molecule):</dt><dd><p>Find the molecule (a string corresponding to a protein id or modified
peptide sequence) in the list of ProblemNetworks and returns the
corresponding network.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-protein_inference.processing.processed_psms">
<span id="processing"></span><h2>Processing<a class="headerlink" href="#module-protein_inference.processing.processed_psms" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt id="protein_inference.processing.processed_psms.ProcessedPSMs">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.processing.processed_psms.</code><code class="sig-name descname">ProcessedPSMs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.processing.processed_psms.ProcessedPSMs" title="Permalink to this definition"></a></dt>
<dd><p>A class that bundles a psm table in a pandas dataframe
with some useful methods.</p>
<dl class="simple">
<dt>df<span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas dataframe containing the psms list.</p>
</dd>
</dl>
<dl class="simple">
<dt>get_proteins()</dt><dd><p>Returns a list of proteins contained in the dataframe
attribute.</p>
</dd>
<dt>get_peptides()</dt><dd><p>Returns a list of peptides contained in the dataframe
attribute.</p>
</dd>
<dt>get_shape()</dt><dd><p>Returns the shape of the dataframe attribute in a
length 2 tuple.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-protein_inference.processing.psms_preprocessor"></span><dl class="py class">
<dt id="protein_inference.processing.psms_preprocessor.PSMsPreprocessor">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.processing.psms_preprocessor.</code><code class="sig-name descname">PSMsPreprocessor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">partial</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">decoy</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.processing.psms_preprocessor.PSMsPreprocessor" title="Permalink to this definition"></a></dt>
<dd><p>A class that collects methods for preprocessing a psms list
contained in a pandas dataframe.</p>
<dl class="simple">
<dt>PSMs<span class="classifier">pandas.DataFrame</span></dt><dd><p>a pandas dataframe containing the psms list.</p>
</dd>
<dt>partial<span class="classifier">int</span></dt><dd><p>The number of psms to retrieve if a partial
processing is to be done. 0 implies complete
processing.</p>
</dd>
<dt>decoy<span class="classifier">bool</span></dt><dd><p>0 if input needs to be processed to remove
decoy proteins</p>
</dd>
</dl>
<dl class="simple">
<dt>get_processed_psms(df, partial=0, decoy=0)</dt><dd><p>Applies a series of preprocessing methods to the
PSMs attribute and returns the preprocessed
data as a ProcessedPSMs object.</p>
</dd>
<dt>_preprocess_q_values(df)</dt><dd><p>Returns only the psms with q_value &lt; 0.01</p>
</dd>
<dt>_preprocess_columns(df)</dt><dd><p>Returns the highest scoring/lowest pep/lowest q value
associated with each psm</p>
</dd>
<dt>_preprocess_duplicates(df)</dt><dd><p>Splits rows that have duplicate proteins id’s
into rows in the dataframe.</p>
</dd>
<dt>_preprocess_decoys(df)</dt><dd><p>Removes rows with a protein id prefixed by decoy</p>
</dd>
<dt>_preprocess_column_names(df)</dt><dd><p>Rename columns where percolator naming is used
to more generic column names</p>
</dd>
<dt>_preprocess_no_q_values(df)</dt><dd><p>If no q values are present in the psms list,
set all q values to negative one.</p>
</dd>
</dl>
<p>Warning: _preprocess_no_q_values(df) allows use of potentially
bad psms because information is available for filtering
matches.</p>
</dd></dl>

<span class="target" id="module-protein_inference.processing.psms_network_splitter"></span><dl class="py class">
<dt id="protein_inference.processing.psms_network_splitter.PSMsNetworkSplitter">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.processing.psms_network_splitter.</code><code class="sig-name descname">PSMsNetworkSplitter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.processing.psms_network_splitter.PSMsNetworkSplitter" title="Permalink to this definition"></a></dt>
<dd><p>A class that splits a networkx graph generated a psm
table.</p>
<dl class="simple">
<dt>network<span class="classifier">networkx.Graph</span></dt><dd><p>A networkx graph generated by PSMsNetworkGenerator.</p>
</dd>
</dl>
<dl class="simple">
<dt>split_networks()</dt><dd><p>Splits the networkx graph into connected components,
converts them into ProblemNetworks and returns
the results as a list.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-protein_inference.processing.psms_network_generator"></span><dl class="py class">
<dt id="protein_inference.processing.psms_network_generator.PSMsNetworkGenerator">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.processing.psms_network_generator.</code><code class="sig-name descname">PSMsNetworkGenerator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">PSMs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.processing.psms_network_generator.PSMsNetworkGenerator" title="Permalink to this definition"></a></dt>
<dd><p>A class that generates a networkx graph from a psm
table.</p>
<dl class="simple">
<dt>PSMs<span class="classifier">ProcessedPSMs</span></dt><dd><p>A ProcessedPSMs instance.</p>
</dd>
</dl>
<dl class="simple">
<dt>generate_network()</dt><dd><p>Generates the networkx graph with appropriate node
types, labels and edge attributes.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-protein_inference.inference.false_discovery_rate_calculator">
<span id="inference"></span><h2>Inference<a class="headerlink" href="#module-protein_inference.inference.false_discovery_rate_calculator" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt id="protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.inference.false_discovery_rate_calculator.</code><code class="sig-name descname">FalseDiscoveryRateCalculator</code><a class="headerlink" href="#protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator" title="Permalink to this definition"></a></dt>
<dd><p>Packages related function for estimating false discovery
rates and q - values.</p>
<dl class="py method">
<dt id="protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator.FDR">
<code class="sig-name descname">FDR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">decoy</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator.FDR" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the false discovery rate at a given
threshold based on the score distributions in
the target and decoy pandas tables. ‘</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<em>float</em>) – A number between 0 and 1.</p></li>
<li><p><strong>target</strong> (<em>pandas.DataFrame</em>) – A target protein table produced by ProteinInferenceRunner().get_output()</p></li>
<li><p><strong>decoy</strong> (<em>pandas.DataFrame</em>) – A decoy protein table produced by ProteinInferenceRunner().get_output()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator.tag_FDR">
<code class="sig-name descname">tag_FDR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">decoy</span></em>, <em class="sig-param"><span class="n">entrapment</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator.tag_FDR" title="Permalink to this definition"></a></dt>
<dd><p>Creates an FDR column in the target table. If
entrapment is set to true it changes the column
name (used in benchmarking.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>pandas.DataFrame</em>) – A target protein table produced by ProteinInferenceRunner().get_output()</p></li>
<li><p><strong>decoy</strong> (<em>pandas.DataFrame</em>) – A decoy protein table produced by ProteinInferenceRunner().get_output()</p></li>
<li><p><strong>entrapment</strong> (<em>bool</em>) – Indicates whether or not to prefix the FDR column with “entrapment”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator.tag_q_value">
<code class="sig-name descname">tag_q_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">decoy</span></em>, <em class="sig-param"><span class="n">entrapment</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.inference.false_discovery_rate_calculator.FalseDiscoveryRateCalculator.tag_q_value" title="Permalink to this definition"></a></dt>
<dd><p>Create a q-value column for the target table
based on the score distributions in the
target and decoy pandas tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>pandas.DataFrame</em>) – A target protein table produced by ProteinInferenceRunner().get_output()</p></li>
<li><p><strong>decoy</strong> (<em>pandas.DataFrame</em>) – A decoy protein table produced by ProteinInferenceRunner().get_output()</p></li>
<li><p><strong>entrapment</strong> (<em>bool</em>) – Indicates whether or not to prefix the FDR column with “entrapment”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-protein_inference.inference.protein_merger"></span><dl class="py class">
<dt id="protein_inference.inference.protein_merger.ProteinMerger">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.inference.protein_merger.</code><code class="sig-name descname">ProteinMerger</code><a class="headerlink" href="#protein_inference.inference.protein_merger.ProteinMerger" title="Permalink to this definition"></a></dt>
<dd><p>A class responsible for identifying indistinguishable proteins
inside a problem network and mergine those nodes.</p>
<dl class="simple">
<dt>run(pn):</dt><dd><p>Merges proteins with the the same peptide connections and
returns an updated problem network.</p>
</dd>
<dt>_list_to_string(l):</dt><dd><p>Utility for converting a list to a string seperated by
semi-colons.</p>
</dd>
<dt>_string_to_list(l):</dt><dd><p>Utility for a string seperated by
semi-colons to a list.</p>
</dd>
<dt>get_mapping(pn):</dt><dd><p>Identifies proteins with same peptide neighbors, returning
a dataframe of peptide neighbour list, protein list pairs.</p>
</dd>
<dt>get_named_proteins(pn):</dt><dd><p>Chooses proteins from the protein lists with the same
peptide neighbours to keep (by sort order). Returns
a dataframe indicating these.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-protein_inference.inference.scorers"></span><dl class="py class">
<dt id="protein_inference.inference.scorers.BestPeptideScorer">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.inference.scorers.</code><code class="sig-name descname">BestPeptideScorer</code><a class="headerlink" href="#protein_inference.inference.scorers.BestPeptideScorer" title="Permalink to this definition"></a></dt>
<dd><p>A class that includes one function, run, which takes a
problem network and scores peptides use the best peptide
method.</p>
<dl class="py method">
<dt id="protein_inference.inference.scorers.BestPeptideScorer.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.inference.scorers.BestPeptideScorer.run" title="Permalink to this definition"></a></dt>
<dd><p>Scores proteins using the PEP Product Method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pn</strong> (<a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork"><em>ProblemNetwork</em></a>) – An instance of the problem network object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pn</strong> – An instance of the problem network object where
protein nodes have a score attribute.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork">ProblemNetwork</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="protein_inference.inference.scorers.BestTwoPeptideScorer">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.inference.scorers.</code><code class="sig-name descname">BestTwoPeptideScorer</code><a class="headerlink" href="#protein_inference.inference.scorers.BestTwoPeptideScorer" title="Permalink to this definition"></a></dt>
<dd><p>A class that includes one function, run, which takes a
problem network and scores peptides use the best peptide
method.</p>
<dl class="py method">
<dt id="protein_inference.inference.scorers.BestTwoPeptideScorer.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.inference.scorers.BestTwoPeptideScorer.run" title="Permalink to this definition"></a></dt>
<dd><p>Scores proteins using the Best Two Peptides method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pn</strong> (<a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork"><em>ProblemNetwork</em></a>) – An instance of the problem network object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pn</strong> – An instance of the problem network object where
protein nodes have a score attribute.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork">ProblemNetwork</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="protein_inference.inference.scorers.PEPProductScorer">
<em class="property">class </em><code class="sig-prename descclassname">protein_inference.inference.scorers.</code><code class="sig-name descname">PEPProductScorer</code><a class="headerlink" href="#protein_inference.inference.scorers.PEPProductScorer" title="Permalink to this definition"></a></dt>
<dd><p>A class that includes one function, run, which takes a
problem network and scores peptides use the PEP Product
method.</p>
<dl class="py method">
<dt id="protein_inference.inference.scorers.PEPProductScorer.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#protein_inference.inference.scorers.PEPProductScorer.run" title="Permalink to this definition"></a></dt>
<dd><p>Scores proteins using the PEP Product Method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pn</strong> (<a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork"><em>ProblemNetwork</em></a>) – An instance of the problem network object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pn</strong> – An instance of the problem network object where
protein nodes have a score attribute.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#protein_inference.problem_network.ProblemNetwork" title="protein_inference.problem_network.ProblemNetwork">ProblemNetwork</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="license.html" class="btn btn-neutral float-left" title="License" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="to_do_list.html" class="btn btn-neutral float-right" title="To Do List" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Mass Dynamics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>